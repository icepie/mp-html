"use strict";var t=require("./context");Component({data:{time:"00:00"},props:{name:"",author:"",poster:"",autoplay:!1,controls:!1,loop:!1,src:""},didMount:function(){var t=this;this._ctx=my.createInnerAudioContext(),this._ctx.onError(function(i){t.setData({error:!0}),t.props.onError&&t.props.onError(i)}),this._ctx.onTimeUpdate(function(){var i=t._ctx.currentTime,e=parseInt(i/60),s=Math.ceil(i%60),a={};a.time=(e>9?e:"0"+e)+":"+(s>9?s:"0"+s),t.lastTime||(a.value=i/t._ctx.duration*100),t.setData(a)}),this._ctx.onEnded(function(){t.props.loop||t.setData({playing:!1})})},didMount:function(){t.set(this.id,this),t.set(this.props.id,this),this.setSrc(this.props.src)},didUpdate:function(t){t.src!==this.props.src&&this.setSrc(this.props.src)},didUnmount:function(){this._ctx.destroy()},pageLifetimes:{show:function(){this.data.playing&&this._ctx.paused&&this._ctx.play()}},methods:{setSrc:function(t){this._ctx.autoplay=this.props.autoplay,this._ctx.loop=this.props.loop,this._ctx.src=t,this.props.autoplay&&!this.data.playing&&this.setData({playing:!0})},play:function(){this._ctx.play(),this.setData({playing:!0}),this.props.onPlay&&this.props.onPlay({target:{id:this.props.id}})},pause:function(){this._ctx.pause(),this.setData({playing:!1}),this.props.onPause&&this.props.onPause()},playbackRate:function(t){this._ctx.playbackRate=t},stop:function(){this._ctx.stop(),this.setData({playing:!1,time:"00:00"}),this.props.onStop&&this.props.onStop()},seek:function(t){this._ctx.seek(t)},_seeking:function(t){if(!(t.timeStamp-this.lastTime<200)){var i=Math.round(t.detail.value/100*this._ctx.duration),e=parseInt(i/60),s=i%60;this.setData({time:(e>9?e:"0"+e)+":"+(s>9?s:"0"+s)}),this.lastTime=t.timeStamp}},_seeked:function(t){this._ctx.seek(t.detail.value/100*this._ctx.duration),this.lastTime=void 0}}});